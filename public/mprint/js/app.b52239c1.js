(function(e){function t(t){for(var o,c,s=t[0],i=t[1],l=t[2],d=0,b=[];d<s.length;d++)c=s[d],Object.prototype.hasOwnProperty.call(r,c)&&r[c]&&b.push(r[c][0]),r[c]=0;for(o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o]);u&&u(t);while(b.length)b.shift()();return a.push.apply(a,l||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,s=1;s<n.length;s++){var i=n[s];0!==r[i]&&(o=!1)}o&&(a.splice(t--,1),e=c(c.s=n[0]))}return e}var o={},r={app:0},a=[];function c(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.m=e,c.c=o,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)c.d(n,o,function(t){return e[t]}.bind(null,o));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],i=s.push.bind(s);s.push=t,s=s.slice();for(var l=0;l<s.length;l++)t(s[l]);var u=i;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("7a23"),r=n("5fbe"),a=n.n(r),c=Object(o["g"])("div",{class:"container"},[Object(o["g"])("div",{class:"title"}," Отслеживание статуса заявки на заправку и ремонт картриджей "),Object(o["g"])("div",{class:"logo"},[Object(o["g"])("img",{class:"imglogo",src:a.a,alt:"logo"})])],-1),s={class:"contain"},i=Object(o["g"])("i",{class:"btn-new fa-solid fa-circle-plus"},null,-1),l=[i],u={class:"footer"},d={class:"date"},b=Object(o["g"])("i",{class:"fa-regular fa-trash-can"},null,-1),f=[b],p=Object(o["g"])("label",{for:"username"},"Пользователь:",-1),m=Object(o["g"])("label",{for:"printer"},"Модель принтера:",-1),g=Object(o["g"])("label",{for:"cartridge"},"Тип картриджа:",-1),j=Object(o["g"])("label",{for:"location"},"Местонахождение принтера / МФУ:",-1),w=Object(o["g"])("label",{for:"workstatus"},"Статус работы:",-1),O=Object(o["g"])("label",{for:"datein"},"Дата приемки на заправку/ремонт:",-1),h=Object(o["g"])("label",{for:"comment"},"Комментарий:",-1),v={class:"modal-footer"},y=Object(o["g"])("h4",null,"Создание новой заявки",-1),k=Object(o["g"])("label",{for:"username"},"Пользователь:",-1),x=Object(o["g"])("label",{for:"printer"},"Модель принтера:",-1),_=Object(o["g"])("label",{for:"cartridge"},"Тип картриджа:",-1),C=Object(o["g"])("label",{for:"location"},"Местонахождение принтера / МФУ:",-1),D=Object(o["g"])("label",{for:"workstatus"},"Статус работы:",-1),M=Object(o["g"])("label",{for:"datein"},"Дата приемки на заправку/ремонт:",-1),V=Object(o["g"])("label",{for:"comment"},"Комментарий:",-1),R={class:"modal-footer"};function S(e,t,n,r,a,i){var b=this,S=Object(o["s"])("vue-good-table"),U=Object(o["s"])("modal");return Object(o["m"])(),Object(o["f"])(o["a"],null,[c,Object(o["g"])("div",s,[Object(o["j"])(S,{ref:"vgt",columns:a.columns,rows:a.tasks,styleClass:"vgt-table striped condensed",key:a.appKey,theme:"polar-bear",paginate:!1,onRowClick:i.onRowClick,"sort-options":{enabled:!0,multipleColumns:!0,initialSortBy:[{field:"statuscode",type:"asc"},{field:"id",type:"asc"}]},"search-options":{enabled:!0,placeholder:"Поиск по таблице"}},null,8,["columns","rows","onRowClick"])]),Object(o["y"])(Object(o["g"])("button",{class:"btn-new",onClick:t[0]||(t[0]=function(e){return i.addnew()})},l,512),[[o["w"],a.isAdmin]]),Object(o["g"])("div",u,[Object(o["g"])("div",d,"Версия"+Object(o["t"])(a.version),1)]),Object(o["j"])(U,{ref:"modalEdit"},{header:Object(o["x"])((function(){return[Object(o["g"])("h4",null,"Редактирование заявки №"+Object(o["t"])(r.row.id),1),Object(o["g"])("button",{class:"btn-delete",onClick:t[1]||(t[1]=function(e){return i.delTask()})},f)]})),body:Object(o["x"])((function(){return[p,Object(o["y"])(Object(o["g"])("input",{name:"username","onUpdate:modelValue":t[2]||(t[2]=function(e){return b.row.username=e})},null,512),[[o["v"],b.row.username]]),m,Object(o["y"])(Object(o["g"])("input",{name:"printer","onUpdate:modelValue":t[3]||(t[3]=function(e){return b.row.printer=e})},null,512),[[o["v"],b.row.printer]]),g,Object(o["y"])(Object(o["g"])("input",{name:"cartridge","onUpdate:modelValue":t[4]||(t[4]=function(e){return b.row.cartridge=e})},null,512),[[o["v"],b.row.cartridge]]),j,Object(o["y"])(Object(o["g"])("input",{name:"location","onUpdate:modelValue":t[5]||(t[5]=function(e){return b.row.location=e})},null,512),[[o["v"],b.row.location]]),Object(o["y"])(Object(o["g"])("input",{type:"hidden",name:"statuscode","onUpdate:modelValue":t[6]||(t[6]=function(e){return b.row.statuscode=e})},null,512),[[o["v"],b.row.statuscode]]),w,Object(o["y"])(Object(o["g"])("select",{class:"select-status","onUpdate:modelValue":t[7]||(t[7]=function(e){return b.row.workstatus=e}),onChange:t[8]||(t[8]=function(e){return i.onChangeStatus()})},[(Object(o["m"])(!0),Object(o["f"])(o["a"],null,Object(o["q"])(b.statuses,(function(e,t){return Object(o["m"])(),Object(o["f"])("option",{key:t},Object(o["t"])(e.status),1)})),128))],544),[[o["u"],b.row.workstatus]]),O,Object(o["y"])(Object(o["g"])("input",{name:"datein","onUpdate:modelValue":t[9]||(t[9]=function(e){return b.formatDateIn=e}),type:"date",size:"15"},null,512),[[o["v"],b.formatDateIn]]),h,Object(o["y"])(Object(o["g"])("input",{name:"comment","onUpdate:modelValue":t[10]||(t[10]=function(e){return b.row.comment=e})},null,512),[[o["v"],b.row.comment]])]})),footer:Object(o["x"])((function(){return[Object(o["g"])("div",v,[Object(o["g"])("button",{class:"btn btn--secondary",onClick:t[11]||(t[11]=function(t){return e.$refs.modalEdit.closeModal(!0)})}," Отмена "),Object(o["g"])("button",{class:"btn btn--primary",onClick:t[12]||(t[12]=function(e){return i.saveTask()})},"Сохранить")])]})),_:1},512),Object(o["j"])(U,{ref:"modalNew"},{header:Object(o["x"])((function(){return[y]})),body:Object(o["x"])((function(){return[k,Object(o["y"])(Object(o["g"])("input",{name:"username","onUpdate:modelValue":t[13]||(t[13]=function(e){return b.row.username=e})},null,512),[[o["v"],b.row.username]]),x,Object(o["y"])(Object(o["g"])("input",{name:"printer","onUpdate:modelValue":t[14]||(t[14]=function(e){return b.row.printer=e})},null,512),[[o["v"],b.row.printer]]),_,Object(o["y"])(Object(o["g"])("input",{name:"cartridge","onUpdate:modelValue":t[15]||(t[15]=function(e){return b.row.cartridge=e})},null,512),[[o["v"],b.row.cartridge]]),C,Object(o["y"])(Object(o["g"])("input",{name:"location","onUpdate:modelValue":t[16]||(t[16]=function(e){return b.row.location=e})},null,512),[[o["v"],b.row.location]]),Object(o["y"])(Object(o["g"])("input",{type:"hidden",name:"statuscode","onUpdate:modelValue":t[17]||(t[17]=function(e){return b.row.statuscode=e})},null,512),[[o["v"],b.row.statuscode]]),D,Object(o["y"])(Object(o["g"])("select",{class:"select-status","onUpdate:modelValue":t[18]||(t[18]=function(e){return b.row.workstatus=e}),onChange:t[19]||(t[19]=function(e){return i.onChangeStatus()})},[(Object(o["m"])(!0),Object(o["f"])(o["a"],null,Object(o["q"])(b.statuses,(function(e,t){return Object(o["m"])(),Object(o["f"])("option",{key:t},Object(o["t"])(e.status),1)})),128))],544),[[o["u"],b.row.workstatus]]),M,Object(o["y"])(Object(o["g"])("input",{name:"datein","onUpdate:modelValue":t[20]||(t[20]=function(e){return b.formatDateIn=e}),type:"date",size:"15"},null,512),[[o["v"],b.formatDateIn]]),V,Object(o["y"])(Object(o["g"])("input",{name:"comment","onUpdate:modelValue":t[21]||(t[21]=function(e){return b.row.comment=e})},null,512),[[o["v"],b.row.comment]])]})),footer:Object(o["x"])((function(){return[Object(o["g"])("div",R,[Object(o["g"])("button",{class:"btn btn--secondary",onClick:t[22]||(t[22]=function(t){return e.$refs.modalNew.closeModal(!0)})}," Отмена "),Object(o["g"])("button",{class:"btn btn--primary",onClick:t[23]||(t[23]=function(e){return i.saveTask()})},"Сохранить")])]})),_:1},512)],64)}var U=n("1da1"),T=(n("96cf"),n("d3b7"),n("caad"),n("2532"),n("99af"),n("ac1f"),n("5319"),n("fb6a"),n("0449")),I=(n("4998"),{key:0,class:"modal"}),$={class:"modal__dialog"},P={class:"modal__header"},F={class:"modal__body"},A={class:"modal__footer"};function E(e,t,n,r,a,c){return Object(o["m"])(),Object(o["d"])(o["b"],{name:"fade"},{default:Object(o["x"])((function(){return[a.show?(Object(o["m"])(),Object(o["f"])("div",I,[Object(o["g"])("div",{class:"modal__backdrop",onClick:t[0]||(t[0]=function(e){return c.closeModal(!0)})}),Object(o["g"])("div",$,[Object(o["g"])("div",P,[Object(o["r"])(e.$slots,"header",{},void 0,!0)]),Object(o["g"])("div",F,[Object(o["r"])(e.$slots,"body",{},void 0,!0)]),Object(o["g"])("div",A,[Object(o["r"])(e.$slots,"footer",{},void 0,!0)])])])):Object(o["e"])("",!0)]})),_:3})}var q={name:"Modal",data:function(){return{show:!1}},methods:{closeModal:function(e){this.show=!1,document.querySelector("body").classList.remove("overflow-hidden"),e&&this.$parent.appKey++},openModal:function(){this.show=!0,document.querySelector("body").classList.add("overflow-hidden")}}},N=(n("8231"),n("6b0d")),K=n.n(N);const z=K()(q,[["render",E],["__scopeId","data-v-72893b16"]]);var J=z,L="http://localhost:8182",B={components:{VueGoodTable:T["a"],Modal:J},name:"App",setup:function(){var e=Object(o["p"])({});return{row:e}},data:function(){return{version:" 0.9.8 от 29.01.2022 г.",columns:[{label:"№",field:"id"},{label:"Пользователь",field:"username"},{label:"Модель принтера",field:"printer",filterable:!0},{label:"Тип картриджа",field:"cartridge",filterable:!0},{field:"statuscode",hidden:!0},{label:"Статус",field:"workstatus",filterable:!0,tdClass:this.tdClassFunc},{label:"Местонахождение",field:"location",filterable:!0},{label:"Дата",field:"datein",filterable:!0,formatFn:this.viewDateFn},{label:"Примечание",field:"comment",filterable:!0}],appKey:0,tasks:[],allowedIp:["1","127.0.0.1","192.168.1.251","10.80.199.73"],isAdmin:!1,client:"",updated:"29.01.2022 16:59",statuses:[{code:30,status:"В ожидании заправки/ремонта"},{code:40,status:"В работе"},{code:10,status:"Заправлен"},{code:20,status:"Поставлен в резерв"}]}},methods:{tdClassFunc:function(e){switch(e.statuscode){case 10:return"green-status";case 20:return"orange-status";case 30:case 40:return"red-status"}},bdinit:function(){var e=this;return Object(U["a"])(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(L,"/mprintinit"));case 2:return n=t.sent,t.next=5,n.json();case 5:o=t.sent,e.tasks=o;case 7:case"end":return t.stop()}}),t)})))()},getip:function(){var e=this;return Object(U["a"])(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,fetch("".concat(L,"/getip"));case 2:if(n=t.sent,!n.ok){t.next=10;break}return t.next=6,n.json();case 6:o=t.sent,o&&(e.client=o.ip,e.isAdmin=e.allowedIp.includes(o.ip)),t.next=11;break;case 10:console.log("Ошибка init: ".concat(n.status));case 11:case"end":return t.stop()}}),t)})))()},parseDate:function(e){var t=new Date(e),n=t.getFullYear(),o=t.getMonth()<9?"0"+(t.getMonth()+1):t.getMonth()+1,r=t.getDate()<9?"0"+t.getDate():t.getDate();return{day:r,month:o,year:n}},viewDateFn:function(e){var t=this.parseDate(e);return"".concat(t.day,".").concat(t.month,".").concat(t.year)},addnew:function(){this.row={id:"",username:"",printer:"",cartridge:"",location:"",statuscode:"",workstatus:"",datein:new Date,comment:""},this.$refs.modalNew.openModal()},delTask:function(){var e=this;return Object(U["a"])(regeneratorRuntime.mark((function t(){var n,o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n="Удаление записи: id:".concat(e.row.id,"_user:").concat(e.row.username,"_model:").concat(e.row.printer,"_cartridge:").concat(e.row.cartridge,"\n_status:").concat(e.row.workstatus,"_location:").concat(e.row.location,"_description:").concat(e.row.comment,"_date:").concat(e.formatDateIn),t.prev=1,t.next=4,fetch("".concat(L,"/mprintdelete/").concat(e.row.id));case 4:if(o=t.sent,!o.ok){t.next=13;break}return t.next=8,o.json();case 8:r=t.sent,console.log("Запись успешно удалена: ",r),e.savelog(n),e.$refs.modalEdit.closeModal(!0),e.bdinit();case 13:t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](1),console.log("Ошибка запроса /mprintdelete",t.t0);case 18:case"end":return t.stop()}}),t,null,[[1,15]])})))()},saveTask:function(){var e=this;return Object(U["a"])(regeneratorRuntime.mark((function t(){var n,o,r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new FormData,n.append("id",e.row.id),n.append("username",e.row.username),n.append("printer",e.row.printer),n.append("cartridge",e.row.cartridge),n.append("workstatus",e.row.workstatus),n.append("statuscode",e.row.statuscode),n.append("location",e.row.location),n.append("datein",e.formatDateIn),n.append("comment",e.row.comment),t.prev=10,t.next=13,fetch("".concat(L,"/mprintupdate"),{method:"POST",mode:"no-cors",headers:{"Content-Type":"form-data"},body:n});case 13:if(o=t.sent,!o.ok){t.next=19;break}return t.next=17,o.json();case 17:r=t.sent,console.log("Данные сохранены: ",r);case 19:t.next=24;break;case 21:t.prev=21,t.t0=t["catch"](10),console.log("Ошибка запроса /mprintupdate",t.t0);case 24:a="Сохранение записи: id:".concat(e.row.id,"_user:").concat(e.row.username,"_model:").concat(e.row.printer,"_cartridge:").concat(e.row.cartridge,"\n_status:").concat(e.row.workstatus,"_location:").concat(e.row.location,"_description:").concat(e.row.comment,"_date:").concat(e.formatDateIn),e.savelog(a),e.$refs.modalEdit.closeModal(!1),e.$refs.modalNew.closeModal(!1),e.bdinit();case 29:case"end":return t.stop()}}),t,null,[[10,21]])})))()},onRowClick:function(e){this.row=e.row,this.isAdmin&&this.$refs.modalEdit.openModal()},onChangeStatus:function(){for(var e=0;e<this.statuses.length;e++)this.row.workstatus===this.statuses[e].status&&(this.row.statuscode=this.statuses[e].code)},savelog:function(e){var t=this;return Object(U["a"])(regeneratorRuntime.mark((function n(){var o,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=(new Date).toISOString().slice(0,19).replace("T"," "),r=new FormData,r.append("description",e),r.append("datetime",o),r.append("client",t.client),n.prev=5,n.next=8,fetch("".concat(L,"/mprint/savelog"),{method:"POST",mode:"no-cors",body:r,headers:{"Content-Type":"form-data"}}).then((function(e){return e.json()})).then((function(e){console.log("Success:",e)}));case 8:n.next=13;break;case 10:n.prev=10,n.t0=n["catch"](5),console.error("Ошибка logging:",n.t0);case 13:case"end":return n.stop()}}),n,null,[[5,10]])})))()}},computed:{formatDateIn:{get:function(){var e=this.parseDate(this.row.datein);return"".concat(e.year,"-").concat(e.month,"-").concat(e.day)},set:function(e){this.row.datein=e}}},mounted:function(){var e=this;return Object(U["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.bdinit(),e.getip();case 2:case"end":return t.stop()}}),t)})))()}};n("72f7");const G=K()(B,[["render",S]]);var Y=G;Object(o["c"])(Y).mount("#app")},"5fbe":function(e,t,n){e.exports=n.p+"img/logo2.5b544e11.png"},"697d":function(e,t,n){},"72f7":function(e,t,n){"use strict";n("697d")},8231:function(e,t,n){"use strict";n("da0f")},da0f:function(e,t,n){}});
//# sourceMappingURL=app.b52239c1.js.map